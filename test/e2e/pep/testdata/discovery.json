{
  "id": "bgz-test",
  "endpoint": "http://localhost:8080/discovery/bgz-test",
  "presentation_max_validity": 36000,
  "presentation_definition": {
    "id": "pd_bgz_discovery",
    "format": {
      "jwt_vc": {
        "alg": ["PS256", "ES256", "RS256"]
      },
      "jwt_vp": {
        "alg": ["ES256", "PS256", "RS256"]
      }
    },
    "input_descriptors": [
      {
        "id": "id_x509credential",
        "name": "Organization identity from UZI certificate",
        "purpose": "Finding a care organization for authorizing access to medical metadata.",
        "constraints": {
          "fields": [
            {
              "path": ["$.type"],
              "filter": {
                "type": "string",
                "const": "X509Credential"
              }
            },
            {
              "path": ["$.issuer"],
              "purpose": "Only accept credentials from our test CA",
              "filter": {
                "type": "string",
                "pattern": "^did:x509:0:sha256:OPYJNiIh8WSwSDzJL0R2d2yPlolN9eAzZ8zvfMK3lcM::.*$"
              }
            },
            {
              "id": "organization_name",
              "path": ["$.credentialSubject[0].subject.O", "$.credentialSubject.subject.O"],
              "filter": {
                "type": "string"
              }
            },
            {
              "id": "organization_ura",
              "path": ["$.credentialSubject[0].san.otherName", "$.credentialSubject.san.otherName"],
              "filter": {
                "type": "string",
                "pattern": "^[0-9.]+-\\d+-\\d+-S-(\\d+)-00\\.000-\\d+$"
              }
            }
          ]
        }
      }
    ]
  }
}
